<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>souffle: souffle::IndexedInequalityTransformer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">souffle
   &#160;<span id="projectnumber">2.0.0-170-gf943254</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesouffle.html">souffle</a></li><li class="navelem"><a class="el" href="classsouffle_1_1_indexed_inequality_transformer.html">IndexedInequalityTransformer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">souffle::IndexedInequalityTransformer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Removes Inequalities from Indexed Operations and replaces them with a Filter Operation and empty Indexed Operations are coverted to their Non-Indexed semantic equivalent.  
 <a href="classsouffle_1_1_indexed_inequality_transformer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_ram_transforms_8h_source.html">RamTransforms.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for souffle::IndexedInequalityTransformer:</div>
<div class="dyncontent">
<div class="center"><img src="classsouffle_1_1_indexed_inequality_transformer__inherit__graph.png" border="0" usemap="#souffle_1_1_indexed_inequality_transformer_inherit__map" alt="Inheritance graph"/></div>
<map name="souffle_1_1_indexed_inequality_transformer_inherit__map" id="souffle_1_1_indexed_inequality_transformer_inherit__map">
<area shape="rect" id="node2" href="classsouffle_1_1_ram_transformer.html" title="RamTransformer &#160;abstract transformer class for a translation unit " alt="" coords="11,5,193,127"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for souffle::IndexedInequalityTransformer:</div>
<div class="dyncontent">
<div class="center"><img src="classsouffle_1_1_indexed_inequality_transformer__coll__graph.png" border="0" usemap="#souffle_1_1_indexed_inequality_transformer_coll__map" alt="Collaboration graph"/></div>
<map name="souffle_1_1_indexed_inequality_transformer_coll__map" id="souffle_1_1_indexed_inequality_transformer_coll__map">
<area shape="rect" id="node2" href="classsouffle_1_1_ram_transformer.html" title="RamTransformer &#160;abstract transformer class for a translation unit " alt="" coords="5,388,188,509"/>
<area shape="rect" id="node3" href="classsouffle_1_1_ram_index_analysis.html" title="{souffle::RamIndexAnalysis\n||+ getIndexes()\l+ getIndexes()\l+ getSearchSignature()\l+ getSearchSignature()\l+ getSearchSignature()\l+ getSearchSignature()\l+ isTotalSignature()\l+ print()\l+ RamIndexAnalysis()\l+ run()\l}" alt="" coords="213,344,407,553"/>
<area shape="rect" id="node4" href="classsouffle_1_1_ram_analysis.html" title="Abstract class for a RAM Analysis. " alt="" coords="101,145,260,281"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a08fee0b1a5c19e286cba89d315bae9bc"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsouffle_1_1_indexed_inequality_transformer.html#a08fee0b1a5c19e286cba89d315bae9bc">getName</a> () const override</td></tr>
<tr class="memdesc:a08fee0b1a5c19e286cba89d315bae9bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">get name of the transformer  <a href="#a08fee0b1a5c19e286cba89d315bae9bc">More...</a><br /></td></tr>
<tr class="separator:a08fee0b1a5c19e286cba89d315bae9bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4f95073153780488af1f66c8a3e912"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsouffle_1_1_indexed_inequality_transformer.html#aef4f95073153780488af1f66c8a3e912">transformIndexToFilter</a> (<a class="el" href="classsouffle_1_1_ram_program.html">RamProgram</a> &amp;program)</td></tr>
<tr class="memdesc:aef4f95073153780488af1f66c8a3e912"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a box query into a corresponding partial box query operation.  <a href="#aef4f95073153780488af1f66c8a3e912">More...</a><br /></td></tr>
<tr class="separator:aef4f95073153780488af1f66c8a3e912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classsouffle_1_1_ram_transformer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classsouffle_1_1_ram_transformer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classsouffle_1_1_ram_transformer.html">souffle::RamTransformer</a></td></tr>
<tr class="memitem:a09ebbf557165cbdebf5d95d5124f709b inherit pub_methods_classsouffle_1_1_ram_transformer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsouffle_1_1_ram_transformer.html#a09ebbf557165cbdebf5d95d5124f709b">apply</a> (<a class="el" href="classsouffle_1_1_ram_translation_unit.html">RamTranslationUnit</a> &amp;translationUnit)</td></tr>
<tr class="memdesc:a09ebbf557165cbdebf5d95d5124f709b inherit pub_methods_classsouffle_1_1_ram_transformer"><td class="mdescLeft">&#160;</td><td class="mdescRight">apply the transformer to a translation unit  translationUnit that will be transformed.  <a href="classsouffle_1_1_ram_transformer.html#a09ebbf557165cbdebf5d95d5124f709b">More...</a><br /></td></tr>
<tr class="separator:a09ebbf557165cbdebf5d95d5124f709b inherit pub_methods_classsouffle_1_1_ram_transformer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa285cd782e8edb27b0d2a52d751f3f49 inherit pub_methods_classsouffle_1_1_ram_transformer"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsouffle_1_1_ram_transformer.html#aa285cd782e8edb27b0d2a52d751f3f49">~RamTransformer</a> ()=default</td></tr>
<tr class="separator:aa285cd782e8edb27b0d2a52d751f3f49 inherit pub_methods_classsouffle_1_1_ram_transformer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad5eb39b640fa134ef1b31520fef7feeb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsouffle_1_1_indexed_inequality_transformer.html#ad5eb39b640fa134ef1b31520fef7feeb">transform</a> (<a class="el" href="classsouffle_1_1_ram_translation_unit.html">RamTranslationUnit</a> &amp;translationUnit) override</td></tr>
<tr class="memdesc:ad5eb39b640fa134ef1b31520fef7feeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">transform the translation unit / used by apply  translationUnit that will be transformed.  <a href="#ad5eb39b640fa134ef1b31520fef7feeb">More...</a><br /></td></tr>
<tr class="separator:ad5eb39b640fa134ef1b31520fef7feeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab8414f97953e6c66b61dfa7e5cc62d7b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsouffle_1_1_ram_index_analysis.html">RamIndexAnalysis</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsouffle_1_1_indexed_inequality_transformer.html#ab8414f97953e6c66b61dfa7e5cc62d7b">idxAnalysis</a></td></tr>
<tr class="separator:ab8414f97953e6c66b61dfa7e5cc62d7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Removes Inequalities from Indexed Operations and replaces them with a Filter Operation and empty Indexed Operations are coverted to their Non-Indexed semantic equivalent. </p>
<p>If there exists inequality constraints in an Indexed Operation, these constraints will be replaced with a semantically equivalent nested Filter Operation.</p>
<p>Furthermore, if after removing all of these inequality constraints from the Indexed Operation we may find that the Indexed Operation is empty (no constraints). This occurs in the case where an Indexed Operation is composed entirely of inequality constraints. In this situation, the Indexed Operation is empty and replaced with a semantically equivalent Operation. i.e. <a class="el" href="classsouffle_1_1_ram_index_scan.html" title="Search for tuples of a relation matching a criteria. ">RamIndexScan</a> -&gt; <a class="el" href="classsouffle_1_1_ram_scan.html" title="Iterate all tuples of a relation. ">RamScan</a></p>
<p>For example,</p>
<div class="fragment"><div class="line">QUERY</div><div class="line"> ...</div><div class="line"> FOR t1 IN X ON INDEX t1.x &lt; 10 AND t1.y &gt; 20</div><div class="line">   ... <span class="comment">// t1 only has inequality constraints placed on it</span></div></div><!-- fragment --><p>will be rewritten to</p>
<div class="fragment"><div class="line">QUERY</div><div class="line"> ...</div><div class="line">     FOR t1 in X ON INDEX <span class="comment">// empty index since all inequalities have been removed</span></div><div class="line">          IF t1.x &lt; 10 AND t1.y &gt; 20</div><div class="line">              <span class="comment">// replaced with a semantically equivalent filter</span></div><div class="line">    ...</div></div><!-- fragment --><p>will be rewritten to</p>
<div class="fragment"><div class="line">QUERY</div><div class="line"> ...</div><div class="line">     FOR t1 in X <span class="comment">// RamScan instead of RamIndexScan</span></div><div class="line">          IF t1.x &lt; 10 AND t1.y &gt; 20</div><div class="line">              <span class="comment">// replaced with a semantically equivalent filter</span></div><div class="line">    ...</div></div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="_ram_transforms_8h_source.html#l00473">473</a> of file <a class="el" href="_ram_transforms_8h_source.html">RamTransforms.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a08fee0b1a5c19e286cba89d315bae9bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08fee0b1a5c19e286cba89d315bae9bc">&#9670;&nbsp;</a></span>getName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string souffle::IndexedInequalityTransformer::getName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get name of the transformer </p>

<p>Implements <a class="el" href="classsouffle_1_1_ram_transformer.html#ac8533b87fb70032e240b5fc8c40dea33">souffle::RamTransformer</a>.</p>

<p class="definition">Definition at line <a class="el" href="_ram_transforms_8h_source.html#l00475">475</a> of file <a class="el" href="_ram_transforms_8h_source.html">RamTransforms.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                       {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;IndexedInequalityTransformer&quot;</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a id="ad5eb39b640fa134ef1b31520fef7feeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5eb39b640fa134ef1b31520fef7feeb">&#9670;&nbsp;</a></span>transform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool souffle::IndexedInequalityTransformer::transform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsouffle_1_1_ram_translation_unit.html">RamTranslationUnit</a> &amp;&#160;</td>
          <td class="paramname"><em>translationUnit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>transform the translation unit / used by apply  translationUnit that will be transformed. </p>
<p>flag reporting whether the RAM program has changed </p>

<p>Implements <a class="el" href="classsouffle_1_1_ram_transformer.html#a10a0d3a003094ad4a8de96b968d26e29">souffle::RamTransformer</a>.</p>

<p class="definition">Definition at line <a class="el" href="_ram_transforms_8h_source.html#l00485">485</a> of file <a class="el" href="_ram_transforms_8h_source.html">RamTransforms.h</a>.</p>

<p class="reference">References <a class="el" href="_ram_translation_unit_8h_source.html#l00053">souffle::RamTranslationUnit::getAnalysis()</a>, and <a class="el" href="_ram_translation_unit_8h_source.html#l00094">souffle::RamTranslationUnit::getProgram()</a>.</p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                                                 {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="classsouffle_1_1_indexed_inequality_transformer.html#ab8414f97953e6c66b61dfa7e5cc62d7b">idxAnalysis</a> = translationUnit.getAnalysis&lt;RamIndexAnalysis&gt;();</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classsouffle_1_1_indexed_inequality_transformer.html#aef4f95073153780488af1f66c8a3e912">transformIndexToFilter</a>(translationUnit.getProgram());</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="ttc" id="classsouffle_1_1_indexed_inequality_transformer_html_aef4f95073153780488af1f66c8a3e912"><div class="ttname"><a href="classsouffle_1_1_indexed_inequality_transformer.html#aef4f95073153780488af1f66c8a3e912">souffle::IndexedInequalityTransformer::transformIndexToFilter</a></div><div class="ttdeci">bool transformIndexToFilter(RamProgram &amp;program)</div><div class="ttdoc">Converts a box query into a corresponding partial box query operation. </div><div class="ttdef"><b>Definition:</b> <a href="_ram_transforms_8cpp_source.html#l00605">RamTransforms.cpp:605</a></div></div>
<div class="ttc" id="classsouffle_1_1_indexed_inequality_transformer_html_ab8414f97953e6c66b61dfa7e5cc62d7b"><div class="ttname"><a href="classsouffle_1_1_indexed_inequality_transformer.html#ab8414f97953e6c66b61dfa7e5cc62d7b">souffle::IndexedInequalityTransformer::idxAnalysis</a></div><div class="ttdeci">RamIndexAnalysis * idxAnalysis</div><div class="ttdef"><b>Definition:</b> <a href="_ram_transforms_8h_source.html#l00490">RamTransforms.h:490</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsouffle_1_1_indexed_inequality_transformer_ad5eb39b640fa134ef1b31520fef7feeb_cgraph.png" border="0" usemap="#classsouffle_1_1_indexed_inequality_transformer_ad5eb39b640fa134ef1b31520fef7feeb_cgraph" alt=""/></div>
<map name="classsouffle_1_1_indexed_inequality_transformer_ad5eb39b640fa134ef1b31520fef7feeb_cgraph" id="classsouffle_1_1_indexed_inequality_transformer_ad5eb39b640fa134ef1b31520fef7feeb_cgraph">
<area shape="rect" id="node2" href="classsouffle_1_1_ram_translation_unit.html#a9397dc9274dc27e27a2329fae9269b0d" title="templated method to compute/retrieve an analysis for a translation unit " alt="" coords="244,27,447,69"/>
<area shape="rect" id="node5" href="classsouffle_1_1_ram_translation_unit.html#ab464bb1f13b9a284e54b9150582c1b97" title="get the RAM Program of the translation unit " alt="" coords="244,93,447,134"/>
<area shape="rect" id="node3" href="classsouffle_1_1_global.html#a2dcb257b0f98d0b882862427cc965640" title="souffle::Global::config" alt="" coords="495,5,657,32"/>
<area shape="rect" id="node4" href="classsouffle_1_1_debug_report.html#ac0feb8780d23c2ca5d7700e4857b10c4" title="souffle::DebugReport\l::addSection" alt="" coords="497,57,655,98"/>
</map>
</div>

</div>
</div>
<a id="aef4f95073153780488af1f66c8a3e912"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4f95073153780488af1f66c8a3e912">&#9670;&nbsp;</a></span>transformIndexToFilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool souffle::IndexedInequalityTransformer::transformIndexToFilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsouffle_1_1_ram_program.html">RamProgram</a> &amp;&#160;</td>
          <td class="paramname"><em>program</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a box query into a corresponding partial box query operation. </p>
<p>This will turn every box query into a filter operation. </p>

<p class="definition">Definition at line <a class="el" href="_ram_transforms_8cpp_source.html#l00605">605</a> of file <a class="el" href="_ram_transforms_8cpp_source.html">RamTransforms.cpp</a>.</p>

<p class="reference">References <a class="el" href="_ram_transformer_8cpp_source.html#l00031">souffle::RamTransformer::apply()</a>, <a class="el" href="_container_util_8h_source.html#l00166">souffle::clone()</a>, <a class="el" href="_misc_util_8h_source.html#l00119">souffle::fatal()</a>, <a class="el" href="_functional_util_8h_source.html#l00147">souffle::filter()</a>, <a class="el" href="namespacesouffle.html#ac460f7c8b5ab0da53316d6bb32a19f49af803729628adf4199f224c2a225038e9">souffle::GE</a>, <a class="el" href="json11_8h_source.html#l00662">i</a>, <a class="el" href="_ram_utils_8h_source.html#l00030">souffle::isRamUndefValue()</a>, <a class="el" href="namespacesouffle.html#ac460f7c8b5ab0da53316d6bb32a19f49acfe6055d2e0503be378bb63449ec7ba6">souffle::LE</a>, <a class="el" href="_ram_node_8h_source.html#l00088">souffle::makeLambdaRamMapper()</a>, <a class="el" href="html_js_chartist_min_8h_source.html#l00015">p</a>, and <a class="el" href="_ast_visitor_8h_source.html#l00239">souffle::visitDepthFirst()</a>.</p>
<div class="fragment"><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                                                             {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">bool</span> changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// helper for collecting conditions from filter operations</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keyword">auto</span> addCondition = [](std::unique_ptr&lt;RamCondition&gt; condition,</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                std::unique_ptr&lt;RamCondition&gt; c) -&gt; std::unique_ptr&lt;RamCondition&gt; {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span> (condition == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">return</span> c;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keywordflow">return</span> std::make_unique&lt;RamConjunction&gt;(std::move(condition), std::move(c));</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    };</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="namespacesouffle.html#a307bae61c898715dccb57c9732335000">visitDepthFirst</a>(program, [&amp;](<span class="keyword">const</span> RamQuery&amp; query) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        std::function&lt;std::unique_ptr&lt;RamNode&gt;(std::unique_ptr&lt;RamNode&gt;)&gt; indexToFilterRewriter =</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                [&amp;](std::unique_ptr&lt;RamNode&gt; node) -&gt; std::unique_ptr&lt;RamNode&gt; {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="comment">// find a RamIndexOperation</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexOperation* indexOperation = dynamic_cast&lt;RamIndexOperation*&gt;(node.get())) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="keyword">auto</span> attributesToDischarge =</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        <a class="code" href="classsouffle_1_1_indexed_inequality_transformer.html#ab8414f97953e6c66b61dfa7e5cc62d7b">idxAnalysis</a>-&gt;<a class="code" href="classsouffle_1_1_ram_index_analysis.html#a475526dcb15efeaa12e8b561494d74e1">getIndexes</a>(indexOperation-&gt;getRelation()).getAttributesToDischarge();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keyword">auto</span> pattern = indexOperation-&gt;getRangePattern();</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                std::unique_ptr&lt;RamCondition&gt; condition;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <a class="code" href="namespacesouffle.html#aea6467c9cb25842f2665f3e65261aa65">RamPattern</a> updatedPattern;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="keywordflow">for</span> (RamExpression* <a class="code" href="html_js_chartist_min_8h.html#a0e2839cf85d4f50ed7cdcc6c1b3adf83">p</a> : indexOperation-&gt;getRangePattern().first) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    updatedPattern.first.emplace_back(<a class="code" href="html_js_chartist_min_8h.html#a0e2839cf85d4f50ed7cdcc6c1b3adf83">p</a>-&gt;clone());</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keywordflow">for</span> (RamExpression* <a class="code" href="html_js_chartist_min_8h.html#a0e2839cf85d4f50ed7cdcc6c1b3adf83">p</a> : indexOperation-&gt;getRangePattern().second) {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    updatedPattern.second.emplace_back(<a class="code" href="html_js_chartist_min_8h.html#a0e2839cf85d4f50ed7cdcc6c1b3adf83">p</a>-&gt;clone());</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> : attributesToDischarge) {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <span class="comment">// move constraints out of the indexed inequality and into a conjuction</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    std::unique_ptr&lt;RamConstraint&gt; lowerBound;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    std::unique_ptr&lt;RamConstraint&gt; upperBound;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="namespacesouffle.html#aaaed06bbcb6b8efcfd2474b1c5d81aa3">isRamUndefValue</a>(pattern.first[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>])) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        lowerBound = std::make_unique&lt;RamConstraint&gt;(<a class="code" href="namespacesouffle.html#ac460f7c8b5ab0da53316d6bb32a19f49af803729628adf4199f224c2a225038e9">BinaryConstraintOp::GE</a>,</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                std::make_unique&lt;RamTupleElement&gt;(indexOperation-&gt;getTupleId(), <a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>),</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(pattern.first[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>]));</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        condition = addCondition(std::move(condition), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(lowerBound));</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="namespacesouffle.html#aaaed06bbcb6b8efcfd2474b1c5d81aa3">isRamUndefValue</a>(pattern.second[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>])) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                        upperBound = std::make_unique&lt;RamConstraint&gt;(<a class="code" href="namespacesouffle.html#ac460f7c8b5ab0da53316d6bb32a19f49acfe6055d2e0503be378bb63449ec7ba6">BinaryConstraintOp::LE</a>,</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                std::make_unique&lt;RamTupleElement&gt;(indexOperation-&gt;getTupleId(), <a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>),</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(pattern.second[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>]));</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                        condition = addCondition(std::move(condition), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(upperBound));</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <span class="comment">// reset the bounds</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    updatedPattern.first[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = std::make_unique&lt;RamUndefValue&gt;();</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    updatedPattern.second[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>] = std::make_unique&lt;RamUndefValue&gt;();</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="keywordflow">if</span> (condition) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    <span class="keyword">auto</span> nestedOp = <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;indexOperation-&gt;getOperation());</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    <span class="keyword">auto</span> <a class="code" href="namespacesouffle.html#aa0949fa42d9e396bb5407f69b450c1f1">filter</a> = std::make_unique&lt;RamFilter&gt;(std::move(condition), std::move(nestedOp));</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                    <span class="comment">// need to rewrite the node with the same index operation</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexScan* iscan = dynamic_cast&lt;RamIndexScan*&gt;(node.get())) {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        node = std::make_unique&lt;RamIndexScan&gt;(</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;iscan-&gt;getRelation()),</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                iscan-&gt;getTupleId(), std::move(updatedPattern), std::move(filter),</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                iscan-&gt;getProfileText());</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> RamParallelIndexScan* pscan =</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                       dynamic_cast&lt;RamParallelIndexScan*&gt;(node.get())) {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                        node = std::make_unique&lt;RamParallelIndexScan&gt;(</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;pscan-&gt;getRelation()),</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                pscan-&gt;getTupleId(), std::move(updatedPattern), std::move(filter),</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                pscan-&gt;getProfileText());</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexChoice* ichoice = dynamic_cast&lt;RamIndexChoice*&gt;(node.get())) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                        node = std::make_unique&lt;RamIndexChoice&gt;(</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;ichoice-&gt;getRelation()),</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                ichoice-&gt;getTupleId(), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;ichoice-&gt;getCondition()),</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                std::move(updatedPattern), std::move(filter), ichoice-&gt;getProfileText());</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexAggregate* iagg = dynamic_cast&lt;RamIndexAggregate*&gt;(node.get())) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        node = std::make_unique&lt;RamIndexAggregate&gt;(std::move(filter), iagg-&gt;getFunction(),</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;iagg-&gt;getRelation()),</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;iagg-&gt;getExpression()), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;iagg-&gt;getCondition()),</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                std::move(updatedPattern), iagg-&gt;getTupleId());</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        <a class="code" href="namespacesouffle.html#a315141918c39611929a694840f046fb5">fatal</a>(<span class="stringliteral">&quot;New RamIndexOperation subclass found but not supported while making index.&quot;</span>);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            node-&gt;apply(<a class="code" href="namespacesouffle.html#a7fba43e03f480ca372449b103dfc9a2f">makeLambdaRamMapper</a>(indexToFilterRewriter));</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordflow">return</span> node;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        };</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keyword">const_cast&lt;</span>RamQuery*<span class="keyword">&gt;</span>(&amp;query)-&gt;<a class="code" href="classsouffle_1_1_ram_transformer.html#a09ebbf557165cbdebf5d95d5124f709b">apply</a>(<a class="code" href="namespacesouffle.html#a7fba43e03f480ca372449b103dfc9a2f">makeLambdaRamMapper</a>(indexToFilterRewriter));</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    });</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="namespacesouffle.html#a307bae61c898715dccb57c9732335000">visitDepthFirst</a>(program, [&amp;](<span class="keyword">const</span> RamQuery&amp; query) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        std::function&lt;std::unique_ptr&lt;RamNode&gt;(std::unique_ptr&lt;RamNode&gt;)&gt; removeEmptyIndexRewriter =</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                [&amp;](std::unique_ptr&lt;RamNode&gt; node) -&gt; std::unique_ptr&lt;RamNode&gt; {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <span class="comment">// find an IndexOperation</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexOperation* indexOperation = dynamic_cast&lt;RamIndexOperation*&gt;(node.get())) {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                <span class="keyword">auto</span> pattern = indexOperation-&gt;getRangePattern();</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <span class="keywordtype">size_t</span> length = pattern.first.size();</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="keywordtype">bool</span> foundRealIndexableOperation = <span class="keyword">false</span>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> = 0; <a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a> &lt; length; ++<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="comment">// if both bounds are undefined we don&#39;t have a box query</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="namespacesouffle.html#aaaed06bbcb6b8efcfd2474b1c5d81aa3">isRamUndefValue</a>(pattern.first[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>]) &amp;&amp; <a class="code" href="namespacesouffle.html#aaaed06bbcb6b8efcfd2474b1c5d81aa3">isRamUndefValue</a>(pattern.second[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>])) {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    <span class="comment">// if lower and upper bounds are equal its also not a box query</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="keywordflow">if</span> (*(pattern.first[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>]) == *(pattern.second[<a class="code" href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a>])) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                        foundRealIndexableOperation = <span class="keyword">true</span>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                <span class="keywordflow">if</span> (!foundRealIndexableOperation) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    <span class="comment">// need to rewrite the node with a semantically equivalent operation to get rid of the</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    <span class="comment">// index operation i.e. RamIndexScan with no indexable attributes -&gt; RamScan</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexScan* iscan = dynamic_cast&lt;RamIndexScan*&gt;(node.get())) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                        node = std::make_unique&lt;RamScan&gt;(</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;iscan-&gt;getRelation()),</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                                iscan-&gt;getTupleId(), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;iscan-&gt;getOperation()),</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                iscan-&gt;getProfileText());</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> RamParallelIndexScan* pscan =</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                       dynamic_cast&lt;RamParallelIndexScan*&gt;(node.get())) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        node = std::make_unique&lt;RamParallelScan&gt;(</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;pscan-&gt;getRelation()),</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                                pscan-&gt;getTupleId(), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;pscan-&gt;getOperation()),</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                pscan-&gt;getProfileText());</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexChoice* ichoice = dynamic_cast&lt;RamIndexChoice*&gt;(node.get())) {</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                        node = std::make_unique&lt;RamChoice&gt;(</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;ichoice-&gt;getRelation()),</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                ichoice-&gt;getTupleId(), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;ichoice-&gt;getCondition()),</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;ichoice-&gt;getOperation()), ichoice-&gt;getProfileText());</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> RamIndexAggregate* iagg = dynamic_cast&lt;RamIndexAggregate*&gt;(node.get())) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                        node = std::make_unique&lt;RamAggregate&gt;(<a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;iagg-&gt;getOperation()),</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                iagg-&gt;getFunction(),</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                std::make_unique&lt;RamRelationReference&gt;(&amp;iagg-&gt;getRelation()),</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;iagg-&gt;getExpression()), <a class="code" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a>(&amp;iagg-&gt;getCondition()),</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                iagg-&gt;getTupleId());</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                        <a class="code" href="namespacesouffle.html#a315141918c39611929a694840f046fb5">fatal</a>(<span class="stringliteral">&quot;New RamIndexOperation subclass found but not supported while transforming &quot;</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                              <span class="stringliteral">&quot;index.&quot;</span>);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            node-&gt;apply(<a class="code" href="namespacesouffle.html#a7fba43e03f480ca372449b103dfc9a2f">makeLambdaRamMapper</a>(removeEmptyIndexRewriter));</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">return</span> node;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        };</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keyword">const_cast&lt;</span>RamQuery*<span class="keyword">&gt;</span>(&amp;query)-&gt;<a class="code" href="classsouffle_1_1_ram_transformer.html#a09ebbf557165cbdebf5d95d5124f709b">apply</a>(<a class="code" href="namespacesouffle.html#a7fba43e03f480ca372449b103dfc9a2f">makeLambdaRamMapper</a>(removeEmptyIndexRewriter));</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    });</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">return</span> changed;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;}</div><div class="ttc" id="namespacesouffle_html_a7fba43e03f480ca372449b103dfc9a2f"><div class="ttname"><a href="namespacesouffle.html#a7fba43e03f480ca372449b103dfc9a2f">souffle::makeLambdaRamMapper</a></div><div class="ttdeci">LambdaRamNodeMapper&lt; Lambda &gt; makeLambdaRamMapper(const Lambda &amp;lambda)</div><div class="ttdoc">Creates a node mapper based on a corresponding lambda expression. </div><div class="ttdef"><b>Definition:</b> <a href="_ram_node_8h_source.html#l00088">RamNode.h:88</a></div></div>
<div class="ttc" id="namespacesouffle_html_a307bae61c898715dccb57c9732335000"><div class="ttname"><a href="namespacesouffle.html#a307bae61c898715dccb57c9732335000">souffle::visitDepthFirst</a></div><div class="ttdeci">void visitDepthFirst(const AstNode &amp;root, AstVisitor&lt; R, Ps... &gt; &amp;visitor, Args &amp;... args)</div><div class="ttdoc">A utility function visiting all nodes within the ast rooted by the given node recursively in a depth-...</div><div class="ttdef"><b>Definition:</b> <a href="_ast_visitor_8h_source.html#l00239">AstVisitor.h:239</a></div></div>
<div class="ttc" id="json11_8h_html_ae46bd26d7133dfe98f8cec7c5ac5c7a1"><div class="ttname"><a href="json11_8h.html#ae46bd26d7133dfe98f8cec7c5ac5c7a1">i</a></div><div class="ttdeci">size_t i</div><div class="ttdef"><b>Definition:</b> <a href="json11_8h_source.html#l00662">json11.h:662</a></div></div>
<div class="ttc" id="classsouffle_1_1_ram_transformer_html_a09ebbf557165cbdebf5d95d5124f709b"><div class="ttname"><a href="classsouffle_1_1_ram_transformer.html#a09ebbf557165cbdebf5d95d5124f709b">souffle::RamTransformer::apply</a></div><div class="ttdeci">bool apply(RamTranslationUnit &amp;translationUnit)</div><div class="ttdoc">apply the transformer to a translation unit  translationUnit that will be transformed. </div><div class="ttdef"><b>Definition:</b> <a href="_ram_transformer_8cpp_source.html#l00031">RamTransformer.cpp:31</a></div></div>
<div class="ttc" id="namespacesouffle_html_ac460f7c8b5ab0da53316d6bb32a19f49acfe6055d2e0503be378bb63449ec7ba6"><div class="ttname"><a href="namespacesouffle.html#ac460f7c8b5ab0da53316d6bb32a19f49acfe6055d2e0503be378bb63449ec7ba6">souffle::BinaryConstraintOp::LE</a></div></div>
<div class="ttc" id="classsouffle_1_1_ram_index_analysis_html_a475526dcb15efeaa12e8b561494d74e1"><div class="ttname"><a href="classsouffle_1_1_ram_index_analysis.html#a475526dcb15efeaa12e8b561494d74e1">souffle::RamIndexAnalysis::getIndexes</a></div><div class="ttdeci">MinIndexSelection &amp; getIndexes(const RamRelation &amp;rel)</div><div class="ttdoc">get the minimal index cover for a relation </div><div class="ttdef"><b>Definition:</b> <a href="_ram_index_analysis_8cpp_source.html#l00321">RamIndexAnalysis.cpp:321</a></div></div>
<div class="ttc" id="namespacesouffle_html_aaaed06bbcb6b8efcfd2474b1c5d81aa3"><div class="ttname"><a href="namespacesouffle.html#aaaed06bbcb6b8efcfd2474b1c5d81aa3">souffle::isRamUndefValue</a></div><div class="ttdeci">bool isRamUndefValue(const RamExpression *expr)</div><div class="ttdoc">Determines if an expression represents an undefined value. </div><div class="ttdef"><b>Definition:</b> <a href="_ram_utils_8h_source.html#l00030">RamUtils.h:30</a></div></div>
<div class="ttc" id="namespacesouffle_html_aa0949fa42d9e396bb5407f69b450c1f1"><div class="ttname"><a href="namespacesouffle.html#aa0949fa42d9e396bb5407f69b450c1f1">souffle::filter</a></div><div class="ttdeci">std::vector&lt; A &gt; filter(std::vector&lt; A &gt; xs, F &amp;&amp;f)</div><div class="ttdoc">Filter a vector to include certain elements. </div><div class="ttdef"><b>Definition:</b> <a href="_functional_util_8h_source.html#l00147">FunctionalUtil.h:147</a></div></div>
<div class="ttc" id="namespacesouffle_html_aea6467c9cb25842f2665f3e65261aa65"><div class="ttname"><a href="namespacesouffle.html#aea6467c9cb25842f2665f3e65261aa65">souffle::RamPattern</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::unique_ptr&lt; RamExpression &gt; &gt;, std::vector&lt; std::unique_ptr&lt; RamExpression &gt; &gt;&gt; RamPattern</div><div class="ttdoc">Pattern type for lower/upper bound. </div><div class="ttdef"><b>Definition:</b> <a href="_ram_operation_8h_source.html#l00041">RamOperation.h:41</a></div></div>
<div class="ttc" id="namespacesouffle_html_ac460f7c8b5ab0da53316d6bb32a19f49af803729628adf4199f224c2a225038e9"><div class="ttname"><a href="namespacesouffle.html#ac460f7c8b5ab0da53316d6bb32a19f49af803729628adf4199f224c2a225038e9">souffle::BinaryConstraintOp::GE</a></div></div>
<div class="ttc" id="html_js_chartist_min_8h_html_a0e2839cf85d4f50ed7cdcc6c1b3adf83"><div class="ttname"><a href="html_js_chartist_min_8h.html#a0e2839cf85d4f50ed7cdcc6c1b3adf83">p</a></div><div class="ttdeci">a horizontalBars(j=m=void 0===a.axisX.type?new c.AutoScaleAxis(c.Axis.units.x, b.normalized.series, o, c.extend({}, a.axisX,{highLow:d, referenceValue:0})):a.axisX.type.call(c, c.Axis.units.x, b.normalized.series, o, c.extend({}, a.axisX,{highLow:d, referenceValue:0})), l=n=void 0===a.axisY.type?new c.StepAxis(c.Axis.units.y, b.normalized.series, o,{ticks:k}):a.axisY.type.call(c, c.Axis.units.y, b.normalized.series, o, a.axisY)) var p</div><div class="ttdef"><b>Definition:</b> <a href="html_js_chartist_min_8h_source.html#l00015">htmlJsChartistMin.h:15</a></div></div>
<div class="ttc" id="namespacesouffle_html_a315141918c39611929a694840f046fb5"><div class="ttname"><a href="namespacesouffle.html#a315141918c39611929a694840f046fb5">souffle::fatal</a></div><div class="ttdeci">void fatal(const char *format, const Args &amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="_misc_util_8h_source.html#l00119">MiscUtil.h:119</a></div></div>
<div class="ttc" id="namespacesouffle_html_a1f1bffe224fa3568552e95368ece1701"><div class="ttname"><a href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701">souffle::clone</a></div><div class="ttdeci">auto clone(const std::vector&lt; A &gt; &amp;xs)</div><div class="ttdef"><b>Definition:</b> <a href="_container_util_8h_source.html#l00166">ContainerUtil.h:166</a></div></div>
<div class="ttc" id="classsouffle_1_1_indexed_inequality_transformer_html_ab8414f97953e6c66b61dfa7e5cc62d7b"><div class="ttname"><a href="classsouffle_1_1_indexed_inequality_transformer.html#ab8414f97953e6c66b61dfa7e5cc62d7b">souffle::IndexedInequalityTransformer::idxAnalysis</a></div><div class="ttdeci">RamIndexAnalysis * idxAnalysis</div><div class="ttdef"><b>Definition:</b> <a href="_ram_transforms_8h_source.html#l00490">RamTransforms.h:490</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsouffle_1_1_indexed_inequality_transformer_aef4f95073153780488af1f66c8a3e912_cgraph.png" border="0" usemap="#classsouffle_1_1_indexed_inequality_transformer_aef4f95073153780488af1f66c8a3e912_cgraph" alt=""/></div>
<map name="classsouffle_1_1_indexed_inequality_transformer_aef4f95073153780488af1f66c8a3e912_cgraph" id="classsouffle_1_1_indexed_inequality_transformer_aef4f95073153780488af1f66c8a3e912_cgraph">
<area shape="rect" id="node2" href="classsouffle_1_1_ram_transformer.html#a09ebbf557165cbdebf5d95d5124f709b" title="apply the transformer to a translation unit &#160;translationUnit that will be transformed. " alt="" coords="337,449,520,491"/>
<area shape="rect" id="node17" href="namespacesouffle.html#a1f1bffe224fa3568552e95368ece1701" title="souffle::clone" alt="" coords="374,815,483,842"/>
<area shape="rect" id="node18" href="namespacesouffle.html#a315141918c39611929a694840f046fb5" title="souffle::fatal" alt="" coords="377,866,481,893"/>
<area shape="rect" id="node31" href="namespacesouffle.html#aa0949fa42d9e396bb5407f69b450c1f1" title="Filter a vector to include certain elements. " alt="" coords="377,917,481,943"/>
<area shape="rect" id="node33" href="namespacesouffle.html#aaaed06bbcb6b8efcfd2474b1c5d81aa3" title="Determines if an expression represents an undefined value. " alt="" coords="333,967,524,994"/>
<area shape="rect" id="node34" href="namespacesouffle.html#a7fba43e03f480ca372449b103dfc9a2f" title="Creates a node mapper based on a corresponding lambda expression. " alt="" coords="308,1018,549,1045"/>
<area shape="rect" id="node35" href="namespacesouffle.html#a307bae61c898715dccb57c9732335000" title="A utility function visiting all nodes within the ast rooted by the given node recursively in a depth&#45;..." alt="" coords="345,1069,513,1095"/>
<area shape="rect" id="node3" href="classsouffle_1_1_global.html#a2dcb257b0f98d0b882862427cc965640" title="souffle::Global::config" alt="" coords="617,581,780,607"/>
<area shape="rect" id="node4" href="namespacesouffle.html#aecc08c83ad9634fc515b7aa094702949" title="A generic function converting strings into strings (trivial case). " alt="" coords="636,631,761,658"/>
<area shape="rect" id="node5" href="classsouffle_1_1_ram_translation_unit.html#ab464bb1f13b9a284e54b9150582c1b97" title="get the RAM Program of the translation unit " alt="" coords="597,683,800,724"/>
<area shape="rect" id="node6" href="namespacesouffle_1_1test.html#a4195ac46f2a48cfa9b911259a22c3ccb" title="souffle::test::now" alt="" coords="631,749,766,775"/>
<area shape="rect" id="node7" href="classsouffle_1_1_ram_transformer.html#a10a0d3a003094ad4a8de96b968d26e29" title="transform the translation unit / used by apply &#160;translationUnit that will be transformed. " alt="" coords="607,800,790,841"/>
<area shape="rect" id="node8" href="classsouffle_1_1_ram_translation_unit.html#adc388ca999ac2b1a8b584f517e60d930" title="throw away all alive analyses of the translation unit " alt="" coords="597,5,800,47"/>
<area shape="rect" id="node9" href="classsouffle_1_1_ram_transformer.html#ac8533b87fb70032e240b5fc8c40dea33" title="get name of the transformer " alt="" coords="607,71,790,112"/>
<area shape="rect" id="node10" href="namespacesouffle_1_1test.html#a10453085bc4f71f32dcda443d4b3c446" title="souffle::test::count" alt="" coords="627,137,770,163"/>
<area shape="rect" id="node11" href="classsouffle_1_1_ram_translation_unit.html#aa12b4d374b978ea3dea421c11fd55478" title="get debug report " alt="" coords="597,188,800,229"/>
<area shape="rect" id="node12" href="classsouffle_1_1_debug_report.html#a5e9ee78bb3c716e38cb79b485e28eb39" title="souffle::DebugReport\l::startSection" alt="" coords="619,253,778,295"/>
<area shape="rect" id="node13" href="classsouffle_1_1_debug_report.html#a555b97488e24480a728dd1782eafa9db" title="souffle::DebugReport\l::addCodeSection" alt="" coords="619,319,778,360"/>
<area shape="rect" id="node14" href="classsouffle_1_1_debug_report.html#a7e549c285244587078499c95b590d9a1" title="souffle::DebugReport\l::endSection" alt="" coords="619,384,778,425"/>
<area shape="rect" id="node15" href="classsouffle_1_1_ram_translation_unit.html#a34cc65ccb9f56403c617ed235f8100ab" title="get error report " alt="" coords="597,449,800,491"/>
<area shape="rect" id="node16" href="classsouffle_1_1_error_report.html#a43341b617858ddfafb8f893e32d9bd6e" title="souffle::ErrorReport\l::getNumErrors" alt="" coords="625,515,772,556"/>
<area shape="rect" id="node19" href="namespacetinyformat.html#adc3e74768f0e2204f9f9a726fc07ec61" title="tinyformat::format" alt="" coords="627,866,770,893"/>
<area shape="rect" id="node20" href="namespacetinyformat.html#a86ed74eb3ed66a662e96220d877da964" title="Format list of arguments to the stream according to the given format string. " alt="" coords="868,866,1019,893"/>
<area shape="rect" id="node28" href="namespacetinyformat.html#ab7b10973ec89e6601353675a85f99d61" title="tinyformat::makeFormatList" alt="" coords="1087,765,1292,791"/>
<area shape="rect" id="node21" href="namespacetinyformat_1_1detail.html#a9fe547bc617c38498e58c12cce507bec" title="tinyformat::detail\l::formatImpl" alt="" coords="1121,867,1257,908"/>
<area shape="rect" id="node29" href="namespacetinyformat.html#a970fd8292e14eb74ba55bafb41017016" title="tinyformat::printf" alt="" coords="1122,815,1257,842"/>
<area shape="rect" id="node30" href="namespacetinyformat.html#a97775445fea05ffaaa0690ab3bb1a920" title="tinyformat::printfln" alt="" coords="1117,933,1262,959"/>
<area shape="rect" id="node22" href="namespacetinyformat_1_1detail.html#ad3d636b9f85202b515c8940b7fcb62a6" title="tinyformat::detail\l::printFormatStringLiteral" alt="" coords="1341,801,1527,843"/>
<area shape="rect" id="node23" href="namespacetinyformat_1_1detail.html#ab4493739cbfe66bc79867f13f1fdf0db" title="tinyformat::detail\l::streamStateFromFormat" alt="" coords="1340,867,1528,908"/>
<area shape="rect" id="node27" href="classtinyformat_1_1detail_1_1_format_arg.html#acbf435711bbe4a4da7fc81758d7108a9" title="tinyformat::detail\l::FormatArg::format" alt="" coords="1359,932,1509,973"/>
<area shape="rect" id="node24" href="namespacetinyformat_1_1detail.html#a67285e0adb9f4164f9fc30a3eb11c771" title="tinyformat::detail\l::parseIntAndAdvance" alt="" coords="1803,837,1967,879"/>
<area shape="rect" id="node25" href="namespacetinyformat_1_1detail.html#ae1e94cbdd9e7cf26f17856a1792664e1" title="tinyformat::detail\l::parseWidthOrPrecision" alt="" coords="1576,896,1755,937"/>
<area shape="rect" id="node26" href="classtinyformat_1_1detail_1_1_format_arg.html#a91b69f66ce9dc8ca2914dce8985d7a1a" title="tinyformat::detail\l::FormatArg::toInt" alt="" coords="1817,903,1953,944"/>
<area shape="rect" id="node32" href="namespacesouffle.html#a6502e279c40a34078cb9d93a465c7590" title="Filter a vector to exclude certain elements. " alt="" coords="635,917,762,943"/>
<area shape="rect" id="node36" href="namespacesouffle.html#a030c754119d60ea72cff8af5b62710e6" title="A utility function visiting all nodes within the ast rooted by the given node recursively in a depth&#45;..." alt="" coords="615,1061,783,1103"/>
<area shape="rect" id="node37" href="classsouffle_1_1_ast_node.html#a07dd728cde93a2b1d72d987cf54cbd8e" title="Obtain a list of all embedded AST child nodes. " alt="" coords="848,1061,1039,1103"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="ab8414f97953e6c66b61dfa7e5cc62d7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8414f97953e6c66b61dfa7e5cc62d7b">&#9670;&nbsp;</a></span>idxAnalysis</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsouffle_1_1_ram_index_analysis.html">RamIndexAnalysis</a>* souffle::IndexedInequalityTransformer::idxAnalysis</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ram_transforms_8h_source.html#l00490">490</a> of file <a class="el" href="_ram_transforms_8h_source.html">RamTransforms.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ram/transform/<a class="el" href="_ram_transforms_8h_source.html">RamTransforms.h</a></li>
<li>ram/transform/<a class="el" href="_ram_transforms_8cpp_source.html">RamTransforms.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
